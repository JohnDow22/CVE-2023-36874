import sys

def bin_to_c_style(bin_file_path, output_file_path):
    try:
        # Чтение бинарного файла
        with open(bin_file_path, 'rb') as bin_file:
            binary_data = bin_file.read()

        # Конвертация байтов в строку C-стиля
        shellcode = ', '.join(f"0x{byte:02x}" for byte in binary_data)

        # Формирование содержимого файла
        content = f"""#ifndef BINARY_H
#define BINARY_H

// Shellcode
unsigned char payload[] = {{
    {shellcode}
}};
unsigned int payload_len = sizeof(payload);

#endif
"""

        # Запись в выходной файл
        with open(output_file_path, 'w') as output_file:
            output_file.write(content)

        print("Файл успешно создан.")

    except Exception as e:
        print(f"Произошла ошибка: {e}")

def main():
    if len(sys.argv) != 3:
        print("Использование: python convert.py <path_to_bin_file> <output_file_path>")
        sys.exit(1)

    bin_file_path = sys.argv[1]
    output_file_path = sys.argv[2]

    bin_to_c_style(bin_file_path, output_file_path)

if __name__ == "__main__":
    main()